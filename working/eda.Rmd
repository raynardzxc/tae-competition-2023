---
title: "TAE Competition 2023"
output: html_notebook
---

# Import Libraries

```{r}
source("usePackages.R")
edapkgnames <- c("tidyverse","tm","wordcloud","dplyr")
loadPkgs(edapkgnames)
```

# Load Data
Provided with twitter sentiment data containing the following columns:
- `tweet`: (character) a string of letters and symbols representing a tweet
- `sentiment`: (integer) an integer representing a sentiment corresponding to a tweet: 1 indicates negative sentiment, 2 indicates neutral, 3 indicates positive

```{r}
twitter_data <- read.csv("../input/train1.csv")
str(twitter_data)
summary(twitter_data)
```
## Check for any missing values
```{r}
sum(is.na(twitter_data))
```

## Check sentiment class balance
```{r}
sentiment_counts <- table(twitter_data$sentiment)
sentiment_counts
```

## Word Cloud
```{r}
positive_tweets <- twitter_data %>%
  filter(sentiment == 3) %>%
  select(tweet)

corpus <- Corpus(VectorSource(positive_tweets$tweet))
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, removeWords, stopwords("english"))
corpus <- tm_map(corpus, stripWhitespace)

wordcloud(corpus, max.words = 50)
```
```{r}
negative_tweets <- twitter_data %>%
  filter(sentiment == 1) %>%
  select(tweet)

corpus <- Corpus(VectorSource(negative_tweets$tweet))
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, removeWords, stopwords("english"))
corpus <- tm_map(corpus, stripWhitespace)

wordcloud(corpus, max.words = 50)
```
```{r}
neutral_tweets <- twitter_data %>%
  filter(sentiment == 2) %>%
  select(tweet)

corpus <- Corpus(VectorSource(neutral_tweets$tweet))
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, removeWords, stopwords("english"))
corpus <- tm_map(corpus, stripWhitespace)

wordcloud(corpus, max.words = 50)
```
# Train Naive Bayes
## Load the necessary libraries: 
Start by loading the required libraries for data manipulation, modeling, and evaluation.
```{r}
source("usePackages.R")
trainpkgnames <- c("tidyverse","tm","tidymodels")
loadPkgs(trainpkgnames)
# install.packages("cli")
# library(cli)
```

# Train multinomial regression
## Load the necessary libraries: 
Start by loading the required libraries for data manipulation, modeling, and evaluation.
```{r}
source("usePackages.R")
trainpkgnames <- c("tidyverse","text")
loadPkgs(trainpkgnames)
```